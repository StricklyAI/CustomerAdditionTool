# Firewall Customer Addition Automation Tool

This project automates the process of adding new customer objects to Palo Alto Panorama using Ansible and YAML. It provides a user-friendly way to input customer details either manually or through a CSV/Excel file. The script handles validation, generates firewall object names in a specific format, and outputs a structured YAML file for use with Ansible playbooks.

---

## 📋 **Project Overview**
This tool is designed to:
- Prompt users to input customer information.
- Support both manual entry and file uploads (CSV/Excel).
- Validate customer details (e.g., IP address, subnet mask).
- Generate firewall object names in the format `CustomerName_IPAddress_CIDR`.
- Optionally add tags to objects, supporting multiple tags per customer.
- Create a YAML file (`customers.yml`) that can be used in an Ansible playbook to push the configurations to Palo Alto Panorama.
- **Ensure that duplicate `panos_address_object` names are not created.**

---

## 📂 **File Structure**
```
.
├── process_file.py          # Main Python script
├── customers.yml            # YAML file generated by the script
├── add_customer.yml         # Ansible playbook
├── inventory                # Ansible inventory file
├── customer_processing.log  # Log file generated by the script
└── README.md                # This file
```

---

## 🚀 **Getting Started**

### **Prerequisites**
Ensure you have the following installed:
- Python 3.x
- Ansible
- Required Python libraries:
  ```bash
  pip install pandas openpyxl pyyaml tqdm
  ```

### **How to Run the Script**
1. Clone the repository:
   ```bash
   git clone https://github.com/your_org/firewall-customer-tool.git
   cd firewall-customer-tool
   ```
2. Run the script:
   ```bash
   python3 process_file.py
   ```

3. Choose your preferred input method:
   - **Manual Entry**: Enter customer details directly in the console.
   - **File Upload**: Provide a CSV or Excel file containing customer details.

---

## ✏️ **Input Fields Description**

| Field          | Description                         | Example            |
|----------------|-------------------------------------|--------------------|
| CustomerName   | Name of the customer (max 20 chars) | `CompanyA`         |
| CustomerIPAddress | IPv4 address of the customer      | `192.168.1.1`      |
| IPSubnetMask   | Subnet mask in dotted decimal format | `255.255.255.0`    |
| Tags           | Optional, comma-separated tags       | `MFT_Financial,Custom_Tag1` |

---

## 🔧 **Manual Input Example**
```
Script started.

Choose input method:
1. Enter customer details manually
2. Upload a CSV or Excel file

Enter your choice (1/2): 1

Enter customer details manually. Type 'done' to finish.

Customer Name (max 20 characters): CompanyA
Customer IP Address (e.g., 192.168.1.1): 192.168.1.1
Subnet Mask (e.g., 255.255.255.0): 255.255.255.0
Tags (comma-separated, optional - leave blank to skip): MFT_Financial,Custom_Tag1
✅ Customer 'CompanyA' added successfully.
```

---

## 📄 **File Upload Example**
Create a CSV/Excel file with the following format:

| CustomerName | CustomerIPAddress | IPSubnetMask | Tags                |
|--------------|-------------------|--------------|---------------------|
| CompanyA     | 192.168.1.1       | 255.255.255.0 | MFT_Financial,Custom_Tag1 |
| CompanyB     | 192.168.2.1       | 255.255.255.0 | MFT_IHA            |
| CompanyC     | 192.168.3.1       | 255.255.255.0 |                     |

Run the script and provide the file path:
```
Enter the path to the Excel or CSV file: customers.xlsx
Loading Excel file: customers.xlsx
Loaded 3 customer entries from the file.
```

---

## 📂 **Generated YAML File Example**
The script generates a `customers.yml` file with the following structure:

```yaml
customers:
  - CustomerName: "CompanyA"
    CustomerIPAddress: "192.168.1.1"
    IPSubnetMask: "255.255.255.0"
    Tags: ["MFT_Financial", "Custom_Tag1"]
    ObjectName: "CompanyA_192.168.1.1_24"
  - CustomerName: "CompanyB"
    CustomerIPAddress: "192.168.2.1"
    IPSubnetMask: "255.255.255.0"
    Tags: ["MFT_IHA"]
    ObjectName: "CompanyB_192.168.2.1_24"
```

---

## 🔧 **Ansible Playbook Usage**
The provided Ansible playbook (`add_customer.yml`) will use the generated `customers.yml` file to push configurations to Palo Alto Panorama.

### **Ansible Playbook Example**
```yaml
---
- name: Add new customers to Palo Alto Panorama
  hosts: panorama
  connection: local
  gather_facts: no

  tasks:
    - name: Add new customer entries to Panorama
      panos_address_object:
        provider:
          ip_address: "{{ panorama_ip }}"
          username: "{{ panorama_username }}"
          password: "{{ panorama_password }}"
        name: "{{ item.ObjectName }}"
        value: "{{ item.CustomerIPAddress }}/{{ item.IPSubnetMask }}"
        description: "Customer Entry for {{ item.CustomerName }}"
        tag: "{{ item.Tags }}"
      with_items: "{{ customers }}"
```

---

## 📒 **Inventory File Example**
Create an inventory file (`inventory`) to define your Panorama instance:

```
[panorama]
panorama.example.com

[panorama:vars]
panorama_ip=192.168.0.2
panorama_username=admin
panorama_password=admin_password
```

## 🤝 **Contributing**
We welcome contributions! Please fork the repository and submit a pull request with your changes.

---

## 📄 **License**
This project is licensed under the MIT License. See the `LICENSE` file for more details.

